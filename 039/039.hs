import Data.List
-- for "sort"

main = do
    print (euler039 1000)

euler039 n = snd (maximum ([ (x, y) | (x, y) <- (map (\xs@(x:_) -> (length xs, x)) (group (sort [ a+b+c | c <- [1..n/2], b <- [1..c], a <- [1..b], a^2+b^2 == c^2, a+b+c <= n ]))) ]))

--840.0
--real    0m3.439s
--user    0m3.388s
--sys     0m0.041s

--[(1,12.0),(1,24.0),(1,30.0),(1,36.0),(1,40.0),(1,48.0),(1,56.0),(2,60.0),(1,70.0),(1,72.0),(1,80.0),(2,84.0),(2,90.0),(1,96.0),(1,108.0),(1,112.0),(3,120.0),(1,126.0),(2,132.0),(1,140.0),(2,144.0),(1,150.0),(1,154.0),(1,156.0),(1,160.0),(3,168.0),(1,176.0),(3,180.0),(1,182.0),(1,192.0),(1,198.0),(1,200.0),(1,204.0),(1,208.0),(2,210.0),(1,216.0),(1,220.0),(1,224.0),(1,228.0),(1,234.0),(4,240.0),(3,252.0),(1,260.0),(2,264.0),(2,270.0),(1,276.0),(3,280.0),(1,286.0),(2,288.0),(2,300.0),(1,306.0),(1,308.0),(2,312.0),(1,320.0),(1,324.0),(2,330.0),(3,336.0),(1,340.0),(1,348.0),(1,350.0),(1,352.0),(4,360.0),(1,364.0),(1,372.0),(1,374.0),(1,378.0),(1,380.0),(1,384.0),(2,390.0),(1,392.0),(3,396.0),(1,400.0),(2,408.0),(1,416.0),(1,418.0),(5,420.0),(2,432.0),(2,440.0),(1,442.0),(1,444.0),(1,448.0),(2,450.0),(2,456.0),(2,462.0),(2,468.0),(1,476.0),(4,480.0),(1,490.0),(1,492.0),(1,494.0),(4,504.0),(2,510.0),(1,516.0),(2,520.0),(3,528.0),(1,532.0),(3,540.0),(1,544.0),(2,546.0),(2,552.0),(3,560.0),(1,564.0),(2,570.0),(1,572.0),(2,576.0),(2,588.0),(1,594.0),(1,598.0),(3,600.0),(1,608.0),(2,612.0),(2,616.0),(3,624.0),(4,630.0),(1,636.0),(1,640.0),(1,644.0),(1,646.0),(1,648.0),(1,650.0),(5,660.0),(4,672.0),(2,680.0),(2,684.0),(2,690.0),(1,696.0),(2,700.0),(1,702.0),(1,704.0),(1,708.0),(1,714.0),(6,720.0),(2,728.0),(1,732.0),(1,736.0),(1,744.0),(1,748.0),(1,750.0),(4,756.0),(2,760.0),(1,768.0),(2,770.0),(4,780.0),(1,782.0),(1,784.0),(3,792.0),(1,798.0),(2,800.0),(1,804.0),(2,810.0),(2,816.0),(2,828.0),(1,832.0),(1,836.0),(8,840.0),(1,850.0),(1,852.0),(1,858.0),(3,864.0),(2,870.0),(1,874.0),(1,876.0),(3,880.0),(1,882.0),(1,884.0),(1,888.0),(1,896.0),(4,900.0),(2,910.0),(2,912.0),(2,918.0),(2,920.0),(5,924.0),(1,928.0),(1,930.0),(3,936.0),(1,948.0),(1,950.0),(2,952.0),(4,960.0),(1,966.0),(1,972.0),(1,980.0),(1,984.0),(1,986.0),(1,988.0),(4,990.0),(1,992.0),(1,996.0),(1,1000.0)]